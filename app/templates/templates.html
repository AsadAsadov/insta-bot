{% extends "base.html" %}
{% block title %}Templates Â· InstaFlow{% endblock %}
{% block content %}
<div class="card shadow-sm mb-3">
  <div class="card-header bg-white fw-semibold">Create template</div>
  <div class="card-body">
    <form method="post" action="/admin/templates" class="row g-2">
      <div class="col-md-3"><input class="form-control" name="name" placeholder="Template name" required /></div>
      <div class="col-md-2">
        <select class="form-select" name="trigger_type" required>
          <option value="equals">equals</option>
          <option value="contains">contains</option>
          <option value="regex">regex</option>
          <option value="any">any</option>
        </select>
      </div>
      <div class="col-md-3"><input class="form-control" name="trigger_value" placeholder="Trigger value" /></div>
      <div class="col-md-3"><input class="form-control" name="reply_text" placeholder="Reply text" required /></div>
      <div class="col-md-1 form-check d-flex align-items-center">
        <input class="form-check-input ms-2" type="checkbox" name="is_active" checked />
      </div>
      <div class="col-12"><button class="btn btn-primary" type="submit">Create</button></div>
    </form>
  </div>
</div>

<div class="vstack gap-2">
  {% for tpl in templates_list %}
  <div class="card shadow-sm">
    <div class="card-body d-flex flex-wrap gap-2 align-items-center justify-content-between">
      <div>
        <div class="fw-semibold">{{ tpl.name }}</div>
        <div class="small text-body-secondary">{{ tpl.trigger_type }}{% if tpl.trigger_value %}: {{ tpl.trigger_value }}{% endif %}</div>
        <div>{{ tpl.reply_text }}</div>
      </div>
      <div class="d-flex gap-2 align-items-center">
        {% if tpl.is_active %}
        <span class="badge text-bg-success">active</span>
        {% else %}
        <span class="badge text-bg-secondary">inactive</span>
        {% endif %}
        <form method="post" action="/admin/templates/{{ tpl.id }}/toggle"><button class="btn btn-outline-primary btn-sm">Toggle</button></form>
        <form method="post" action="/admin/templates/{{ tpl.id }}/delete"><button class="btn btn-outline-danger btn-sm">Delete</button></form>
      </div>
    </div>
  </div>
  {% else %}
  <div class="text-body-secondary">No templates yet.</div>
  {% endfor %}
</div>
{% endblock %}
