<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}InstaBot Admin{% endblock %}</title>
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous"
    />
    <style>
        :root {
            --app-bg: #f5f6f8;
            --card-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
            --text-muted: #6c757d;
        }
        body {
            background: var(--app-bg);
        }
        body.dark-mode {
            background: #111827;
            color: #e5e7eb;
        }
        body.dark-mode .card,
        body.dark-mode .list-group-item,
        body.dark-mode .navbar,
        body.dark-mode .sidebar {
            background-color: #1f2937 !important;
            color: #e5e7eb;
        }
        body.dark-mode .text-muted {
            color: #9ca3af !important;
        }
        .navbar-brand {
            font-weight: 700;
        }
        .sidebar {
            min-height: calc(100vh - 56px);
            background: #ffffff;
            border-right: 1px solid #e5e7eb;
        }
        .card {
            border: none;
            box-shadow: var(--card-shadow);
        }
        .message-bubble {
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            max-width: 75%;
        }
        .message-in {
            background: #e9f2ff;
            align-self: flex-start;
        }
        .message-out {
            background: #d1fae5;
            align-self: flex-end;
        }
        .badge-soft {
            background: #eef2ff;
            color: #4338ca;
        }
        .thread-active {
            border-left: 4px solid #0d6efd;
        }
        .chat-window {
            max-height: 60vh;
            overflow-y: auto;
        }
        .search-input {
            border-radius: 999px;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container-fluid">
        <a class="navbar-brand" href="/admin">InstaBot Admin</a>
        <div class="d-flex align-items-center gap-2">
            <span class="badge badge-soft">Meta IG</span>
            <button class="btn btn-sm btn-outline-secondary" id="toggleTheme">Toggle dark</button>
        </div>
    </div>
</nav>
<div class="container-fluid">
    <div class="row">
        <aside class="col-lg-2 col-md-3 d-none d-md-block sidebar py-4">
            <div class="px-3">
                <div class="list-group">
                    <a href="/admin" class="list-group-item list-group-item-action">Inbox</a>
                    <a href="/admin/templates" class="list-group-item list-group-item-action">Auto Replies</a>
                </div>
                {% if meta_missing %}
                <div class="alert alert-warning mt-4">
                    Missing META_PAGE_ACCESS_TOKEN. Replies will fail until configured.
                </div>
                {% endif %}
            </div>
        </aside>
        <main class="col-lg-10 col-md-9 ms-sm-auto px-4 py-4">
            {% if flash %}
            <div class="alert alert-{{ flash_type }}">{{ flash }}</div>
            {% endif %}
            {% block content %}{% endblock %}
        </main>
    </div>
</div>
<script>
    const toggleTheme = document.getElementById('toggleTheme');
    const storedTheme = localStorage.getItem('theme');
    if (storedTheme === 'dark') {
        document.body.classList.add('dark-mode');
    }
    if (toggleTheme) {
        toggleTheme.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const mode = document.body.classList.contains('dark-mode') ? 'dark' : 'light';
            localStorage.setItem('theme', mode);
        });
    }
</script>
{% block scripts %}{% endblock %}
</body>
</html>
